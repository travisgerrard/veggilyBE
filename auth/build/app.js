"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.app = void 0;
const express_1 = __importDefault(require("express"));
require("express-async-errors");
const path_1 = __importDefault(require("path"));
const body_parser_1 = require("body-parser");
const cookie_session_1 = __importDefault(require("cookie-session"));
const common_1 = require("@tgticketing/common");
const current_user_1 = require("./routes/users/current-user");
const signin_1 = require("./routes/users/signin");
const signout_1 = require("./routes/users/signout");
const signup_1 = require("./routes/users/signup");
const new_1 = require("./routes/meals/new");
const meals_1 = require("./routes/meals");
const update_1 = require("./routes/meals/update");
const show_1 = require("./routes/meals/show");
const addMealToPlan_1 = require("./routes/meals/addMealToPlan");
const new_2 = require("./routes/ingredients/new");
const ingredients_1 = require("./routes/ingredients");
const update_2 = require("./routes/ingredients/update");
const show_2 = require("./routes/ingredients/show");
const showForMeal_1 = require("./routes/ingredients/showForMeal");
const delete_1 = require("./routes/ingredients/delete");
const decreaseOrderForMeal_1 = require("./routes/ingredients/decreaseOrderForMeal");
const increaseOrderForMeal_1 = require("./routes/ingredients/increaseOrderForMeal");
const addIngredientToList_1 = require("./routes/ingredients/addIngredientToList");
const lists_1 = require("./routes/lists");
const toggle_1 = require("./routes/lists/toggle");
const delete_2 = require("./routes/lists/delete");
const plans_1 = require("./routes/plans");
const toggle_2 = require("./routes/plans/toggle");
const delete_3 = require("./routes/plans/delete");
const update_3 = require("./routes/plans/update");
const new_3 = require("./routes/comments/new");
const comments_1 = require("./routes/comments/");
const update_4 = require("./routes/comments/update");
const delete_4 = require("./routes/comments/delete");
const new_4 = require("./routes/import/new");
const general_1 = require("./routes/import/general");
const instructionsForMeal_1 = require("./routes/instructions/instructionsForMeal");
const increaseInstructionForMeal_1 = require("./routes/instructions/increaseInstructionForMeal");
const decreaseInstructionForMeal_1 = require("./routes/instructions/decreaseInstructionForMeal");
const new_5 = require("./routes/instructions/new");
const delete_5 = require("./routes/instructions/delete");
const instructions_1 = require("./routes/instructions/");
const app = (0, express_1.default)();
exports.app = app;
app.set('trust proxy', true);
app.use((0, body_parser_1.json)());
app.use((0, cookie_session_1.default)({
    signed: false,
    secure: false, //process.env.NODE_ENV !== 'test',
}));
app.use(express_1.default.static(path_1.default.join(__dirname, '../../my-app/out')));
app.use(common_1.currentUser);
app.use(current_user_1.currentUserRouter);
app.use(signin_1.signinRouter);
app.use(signout_1.signoutRouter);
app.use(signup_1.signupRouter);
app.use(meals_1.indexMealRouter);
app.use(new_1.createMealRouter);
app.use(update_1.updateMealRouter);
app.use(show_1.showMealRouter);
app.use(addMealToPlan_1.addMealToPlanRouter);
app.use(addIngredientToList_1.addIngredientToListRouter);
app.use(ingredients_1.indexIngredientRouter);
app.use(new_2.createIngredientRouter);
app.use(update_2.updateIngredientRouter);
app.use(show_2.showIngredientRouter);
app.use(showForMeal_1.showIngredientsForMealRouter);
app.use(delete_1.deleteIngredientRouter);
app.use(decreaseOrderForMeal_1.decreaseIngredientOrderRouter);
app.use(increaseOrderForMeal_1.increaseIngredientOrderRouter);
app.use(lists_1.indexListRouter);
app.use(toggle_1.toggleListRouter);
app.use(delete_2.deleteListRouter);
app.use(plans_1.indexPlanRouter);
app.use(toggle_2.togglePlanRouter);
app.use(delete_3.deletePlanRouter);
app.use(update_3.updatePlanRouter);
app.use(delete_4.deleteCommentRouter);
app.use(new_3.createCommentRouter);
app.use(update_4.updateCommentRouter);
app.use(comments_1.indexCommentsRouter);
app.use(new_4.importMealRouter);
app.use(general_1.generalMealRouter);
app.use(instructionsForMeal_1.showInstructionsForMealRouter);
app.use(increaseInstructionForMeal_1.increaseInstructionOrderRouter);
app.use(decreaseInstructionForMeal_1.decreaseInstructionOrderRouter);
app.use(new_5.createInstructionRouter);
app.use(delete_5.deleteInstructionRouter);
app.use(instructions_1.indexInstructionRouter);
app.get('/', (req, res) => {
    res.sendFile(path_1.default.join(__dirname, '../../my-app/out/index.html'));
});
app.all('*', async () => {
    throw new common_1.NotFoundError();
});
app.use(common_1.errorHandler);
